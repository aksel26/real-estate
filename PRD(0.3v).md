PRD — 지도 기반 전월세 리포트 (단지 랭킹 + 면적대 필터 중심)

버전: v0.3 (MVP)
플랫폼: Web
핵심 타깃: A(이사 준비자), D(콘텐츠 제작자)

⸻

1. 제품 개요

한 줄 설명

지도에서 지역을 선택하면 단지(apt)별 전월세 현황을 랭킹으로 보여주고, 원하는 면적대(㎡)로 필터링해 가격 수준을 빠르게 비교할 수 있는 월간 리포트 앱.

핵심 가치
• A: “어느 단지가 거래가 활발한지 + 내가 보는 평형대에서 가격대가 어떤지”를 즉시 파악
• D: “단지 TOP N + 면적대별 요약”을 리포트/콘텐츠 포맷으로 재사용 가능

⸻

2. 문제 정의
   • 전월세 데이터는 원본 리스트가 많아 “의사결정에 필요한 구조”로 보기 어렵다.
   • 사용자는 실제로 (1) 단지 단위로 판단하고, (2) 면적대로 후보를 좁힌다.
   • 지도 기반 앱에서는 리스트보다 집계/정렬/필터가 UX를 결정한다.

⸻

3. 목표 및 성공 지표

목표 1. 지역 선택 후 단지 랭킹과 면적대 요약이 1 화면에서 완결된다. 2. 면적대 필터 변경 시 **로딩 최소화(캐시 활용)**로 즉시 갱신된다. 3. 표본 기반 집계의 한계를 투명하게 표시해 신뢰를 확보한다.

성공 지표(MVP)
• 지역 선택 후 3초 내 “단지 TOP 리스트”가 보인다(캐시 히트 시 즉시)
• 면적대 필터 변경 시 UI 끊김 없이 결과가 갱신된다
• 표본 부족/대표성 이슈가 있는 경우 경고 배지 노출률 100%

⸻

4. 범위(Scope)

MVP에 포함

A. 지도 기반 지역 선택
• Kakao Map
• 구/동 선택(초기엔 구 단위 가능)
• 선택 지역 표시 + 우측 패널 오픈

B. 단지 랭킹(핵심 #1)
• 선택 지역/월/유형에 대해 단지별로 집계 후 랭킹 노출
• 각 단지 카드에 표시할 항목
• 거래건수(총/전세/월세)
• 대표 가격(전세 보증금 중위, 월세: 보증금 중위 + 월세 중위)
• 대표 평형(중위 면적) 또는 주요 면적대
• 표본수 배지(충분/부족)

C. 면적대 필터 & 요약(핵심 #2)
• 면적대 프리셋 칩(예시)
• ≤40 / 40–60 / 60–85 / 85–110 / 110+
• 필터 적용 시 갱신되는 정보
• 전세 보증금 중위 + 범위(IQR)
• 월세: 보증금 중위 + 월세 중위
• 해당 면적대 거래건수(전세/월세 분리)
• “표본 부족” 시 요약 카드에 경고 배지 표시

D. 마이크로 인터랙션(필수)
• 단지 카드 정렬 변경/필터 변경 시 자연스러운 레이아웃 애니메이션
• 선택 단지 hover → 지도 강조(가능하면 마커/폴리곤 강조)
• 로딩 스켈레톤 및 실패 상태

E. 기술 요구
• Next.js(App Router) + Route Handlers(BFF)
• Tailwind CSS v4
• Framer Motion(Motion)
• TanStack Query(서버 데이터)
• Zustand(UI/지도 상태)

MVP에서 제외
• 청약/공매
• 회원/알림/즐겨찾기(옵션)
• 단지 좌표 정합(초기엔 리스트 중심, 지도는 지역 선택에 초점)

⸻

5. 사용자 시나리오

A(이사 준비자) 1. 지도에서 지역 선택 2. “거래 활발한 단지 TOP”를 보고 후보 단지 3개로 압축 3. 면적대(60–85㎡) 선택 → 내 평형대의 전세/월세 수준 확인 4. 단지 카드 클릭 → 상세(최근 거래 몇 건) 확인

D(콘텐츠 제작자) 1. 여러 지역을 클릭하며 단지 TOP 구성 비교 2. 면적대별 가격 차이를 캡처/요약 3. “지역 리포트” 문장/표로 가공(Export는 V1 혹은 옵션)

⸻

6. 화면/정보 구조(IA)

메인(/)
• 좌측: 지도(지역 선택)
• 우측 패널(2섹션) 1. 면적대 필터 + 요약 카드 2. 단지 랭킹 리스트(Top N)

단지 상세(패널 내부 드릴다운)
• 탭: 전세 / 월세
• 최근 거래 리스트(Top 5~10)
• 표본수/기간/참고 고지

⸻

7. 기능 요구사항(Functional)

7.1 단지 랭킹 집계 로직

입력: items[] (거래 원본)
출력: aptRank[]
• groupBy: aptName
• 계산:
• countTotal, countJeonse, countMonthly
• medianDeposit (전세만)
• medianMonthlyRent (월세만)
• medianMonthlyDeposit (월세만)
• medianArea
• 정렬 기본값:
• countTotal desc (거래 활발한 단지 우선)
• 보조 정렬(옵션):
• 전세 중위 보증금 desc/asc
• 월세 중위 월세 asc/desc

7.2 면적대 필터 로직
• 프리셋 구간에 따라 items 필터링
• 필터된 집합에서 전세/월세 각각 요약 계산
• 표본수 기준:
• 예: sampleCount < 5 → “표본 부족” 배지

7.3 신뢰/고지
• 항상 노출:
• 기간(ym), 표본수(sampleCount), 전세/월세 건수
• 표본 기반 가능성:
• “참고용(표본 기반)” 배지 및 툴팁

⸻

8. 상태 관리 / 데이터 캐싱

원칙
• TanStack Query: 서버 데이터(리포트/집계 결과)
• Zustand: UI/지도 상태(선택 지역, 면적대, 정렬 등)

Zustand 상태(예시)
• selection: selectedLawd, selectedName, selectedYm
• filters: areaBand, rentType(all/jeonse/monthly), sortKey
• ui: panelOpen, selectedAptName

Query Key(예시)
• ['leaseReport', propertyType, lawd, ym] // items + summary
• ['aptRank', propertyType, lawd, ym, areaBand, rentType, sortKey]
• 권장: leaseReport를 받아 클라에서 랭킹/필터 계산(빠름)
• 또는 BFF에서 aptRank API 제공(일관/재사용)

⸻

9. API 설계(권장)

BFF 엔드포인트
• GET /api/lease-report?type=apartment&lawd=11290&ym=202604
• 반환: { items, summary, meta } (현재 너가 준 형태)
• (옵션) GET /api/apt-rank?...
• 반환: { ranks[], meta }

보안
• 키는 MCP/서버에만 존재
• 입력 검증: ym(YYYYMM), lawd(5자리), type whitelist

⸻

10. 마이크로 인터랙션(Motion)

필수
• 면적대 칩 전환: 선택 칩 강조 + 레이아웃 자연 이동(layoutId)
• 단지 리스트 정렬/필터 변화: 카드 재배치 애니메이션(layout)
• 단지 선택 시: 상세 드릴다운(패널 안에서 slide)

⸻

11. 완료 기준(Acceptance)
    • 지역 선택 시 면적대 요약 + 단지 TOP 리스트가 표시된다.
    • 면적대 필터 변경 시 결과가 즉시 갱신되며 UI가 끊기지 않는다.
    • 단지 리스트는 거래건수 기준 기본 정렬을 제공한다.
    • 표본수/기간/참고 고지가 항상 표시된다(표본 부족 배지 포함).
    • API 키는 클라이언트에 노출되지 않는다.

⸻
